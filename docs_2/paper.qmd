---
title: "Robust Automated Brain Extraction of Head CT tool"
author: "Rushil Srirambhatla, John Muschelli"
format: html
editor: visual
bibliography: references.bib
---

# Introduction

X-ray computed tomography (CT) scans are a vital and widely accessible imaging technique healthcare providers use to diagnose and assess neurological conditions [@sahni2007management; @chalela2007magnetic; @schellinger1999standardized]. Segmentation of non-brain tissue from head CT scans—also known as skull stripping or brain extraction—is an essential preprocessing step in neuroimaging research and clinical analysis [@smith2002fast]. By isolating the cortex and cerebellum, this process enables more accurate measurements of brain structures, better detection of lesions, and improved registration to brain templates [@zhuang2006skull]. In brain MRI, numerous automated tools exist for this task [@singh2021review], but head CT scans present unique challenges. CT scans present unique challenges due to high-density bone and variable field-of-view extending to the neck, which can interfere with brain extraction algorithms [@muschelli2019recommendations]. Unlike MRI, CT requires specific preprocessing like Hounsfield unit windowing to separate brain from bone [@muschelli2019recommendations]. These challenges often cause MRI-based tools to fail when applied to CT.

In 2015, [@muschelli2015validated] introduced an adaptation of FSL’s Brain Extraction Tool (BET) specifically for head CT, commonly referred to as BET (Version 1). This method applied intensity windowing (0–100 Hounsfield units) and BET with optimized parameters to CT data, achieving high overlap accuracy (Dice coefficient \~0.99) on a small test set of manually segmented brains [@muschelli2015validated]. BET was one of the first fully automated CT skull stripping techniques and was made publicly available, allowing researchers to process CT scans without manual intervention [@smith2002fast]. In our subsequent testing with larger datasets, we identified several limitations of BET (V1). Approximately 5% of scans could not be processed correctly, resulting in gross failures where the brain mask was unusable. Common error modes included the mask erroneously covering parts of the neck or other extracranial tissues, failing to include the entire brain (holes or missing regions), or a combination of these issues.

Since 2015, there has been substantial progress in automated skull stripping methods, especially driven by advances in machine learning [@pei2022general]. Deep learning-based approaches have achieved state-of-the-art performance in brain extraction for MRI and are increasingly being applied to CT. For example, the HD-BET tool [@isensee2019automated] uses a convolutional neural network trained on a wide range of brain MRI scans (including pathological cases) to produce robust brain masks. While HD-BET was developed for MRI, its architecture has been adapted for CT by some researchers (e.g., via transfer learning in a variant dubbed “HD-CTBET”), demonstrating the potential of CNNs for CT skull stripping. More recently, SynthStrip was introduced as a modality-agnostic brain extraction method trained on synthetically generated data [@hoopes2022synthstrip]. SynthStrip can generalize to any brain imaging modality — from MRI to CT — without needing manual training labels, and it has shown excellent accuracy on diverse datasets. These deep learning tools are publicly accessible (often as open-source software or pretrained models) and have pushed the error rates lower than traditional methods.

Despite these advances, a gap remained in having a highly reliable yet easily deployable skull stripping solution for head CT. Many deep learning solutions require careful retraining or fine-tuning for CT data, and their performance can degrade on images with unusual artifacts or anatomy not represented in training. Traditional methods like CT_BET (V1) are simple to run but prone to specific failure modes as noted. There was a need for an improved method that minimizes failures across a wide variety of scans while using accessible, modifiable components. In this work, we propose Robust Skull Strip (V2), an enhanced skull stripping pipeline that directly addresses the known shortcomings of CT_BET. By introducing targeted preprocessing and processing steps (such as neck removal and mask refinement), Robust Skull Strip V2 achieves a dramatically lower failure rate on large multi-center datasets, without requiring any complex model training or proprietary software.

# Methods

### Robust Skull Strip V2: Method Description

The Robust Skull Strip (V2) method is designed as an improved pipeline over the original CT_BET (V1), directly addressing its known failure modes. The approach emphasizes simplicity and reproducibility: it utilizes widely available software tools and standard imaging resources so that others can implement it with minimal modifications. The workflow proceeds through a series of steps, each targeting a specific aspect of the skull stripping task:

1.  Preprocessing – Intensity Normalization and Smoothing: Each input CT volume is first intensity-windowed to the range of 0–100 Hounsfield Units, focusing on the soft tissue density range that encompasses brain matter while discarding higher-density bone and lower-density air. This is the same window used in CT_BET (V1), ensuring consistency with that baseline. Additionally, V2 applies a mild 3D Gaussian smoothing (σ = 1 mm) to the volume after windowing. The smoothing step reduces noise and small hyperdense artifacts (for example, calcifications or scanning streaks) that might otherwise confuse the brain extraction algorithm. This step was motivated by findings in the original 2015 study that suggested slight smoothing can improve segmentation stability.

2.  Template-Guided Neck Excision (Two-Pass Process): To eliminate the inclusion of neck and other below-brain regions, the pipeline employs a template-guided strategy. First, the head CT is roughly aligned to a reference brain template (for instance, an average brain CT or an MR template in MNI space) using a rigid or affine registration. This transform provides an approximate correspondence between the scan and anatomical landmarks. Using the aligned template, the algorithm identifies the level of the foramen magnum (the base of the skull) and removes all image data below that plane, effectively excising the neck. In practice, this can be done by multiplying the image with a binary mask derived from the template that has value 1 in the brain and skull region and 0 in the neck region. After this first pass neck removal, a provisional brain mask is obtained (using a quick segmentation like a conservative threshold or region growing) to check if any neck or stray regions remain connected to the brain mask. If so, a second pass is performed: the algorithm isolates the largest connected component (which should be the brain) and discards other components, and may apply the template mask again for any residual lower pieces. This two-pass excision ensures that even if the initial template alignment was not perfect, any attached neck or extracranial component that is not contiguous with the brain will be dropped. By the end of this step, the CT volume is essentially cropped to contain mostly the head and brain without the lower neck or shoulders.

3.  Re-centering via Center of Gravity Recalculation: Removing a large portion of the neck and lower head can shift the center of mass of the remaining image. Many brain extraction algorithms, including FSL BET, are sensitive to the initial center point from which they start expanding or contracting a surface to find the brain boundary. In CT_BET V1, the center was effectively fixed or assumed based on the original head volume, which could be biased downward if the neck was present. In V2, after neck excision, the center of gravity of the head’s intensity distribution is recomputed on the cropped image. This new center (which should lie near the middle of the brain) is used to initialize the skull stripping algorithm. By re-centering, we ensure that the subsequent brain extraction focuses on the correct region and is not offset by previously included non-brain parts. This adjustment helps prevent the brain mask from “sliding” off-center or missing the top of the brain due to an initially wrong starting point.

4.  Brain Extraction with Enhanced Parameters: With the image normalized, neck removed, and center defined, the core brain extraction is performed using an adapted BET algorithm (the same fundamental algorithm as in V1, but now with better inputs). The fractional intensity threshold parameter for BET is set to an optimal value (in the original CT_BET study, an aggressive threshold like 0.1 was often used, as lower values help capture the full brain in CT where contrast is low). In V2, we keep this parameter tuned for slight over-segmentation (to avoid missing any brain tissue), since subsequent steps will clean up extras. The BET algorithm then produces an initial brain mask, which, thanks to the preprocessing, is far less likely to include neck or outside tissue. The use of the updated center of gravity helps BET correctly encompass the frontal and dorsal extremities of the brain. This step yields a binary mask labeling the brain region.

5.  Morphological Post-processing (Hole Filling and Smoothing): The initial mask from BET is then refined with morphological operations to address any small defects. In CT_BET V1, a simple hole-filling operation was done to patch internal holes in the mask. V2 goes further by applying a dilate-and-erode sequence (sometimes called *closing* in morphology). Specifically, the brain mask is dilated slightly (using a 3D spherical kernel of radius 5 voxels, for example) to fill in any gaps or weak edges, then eroded by the same amount to return the mask roughly to its original size. This has the effect of closing holes in the mask interior and smoothing the mask outline by removing tiny extrusions or jagged parts that may have been left. The result is a clean, contiguous brain mask that tightly hugs the brain tissue without including extraneous regions. Finally, any isolated fragments (if any remain) that are not connected to the main brain mask are removed. Because the neck was already excised, such fragments are rare except perhaps small bits of skull that might have been misclassified; these are typically eliminated by the morphological operations.

The output of the Robust Skull Strip V2 pipeline is a binary mask of the brain for each input CT scan. This mask can be applied to the original CT image to produce a skull-stripped image, or used as needed in downstream analyses. Notably, each step of the pipeline uses accessible computational tools: e.g., image registration can be done with an open-source library (ANTs or FSL FLIRT), BET is part of the FSL toolkit, and morphological operations can be done with common image processing libraries. The method does not rely on any machine learning model that needs training, which means it can be readily applied to new datasets without additional data collection. Default parameters (such as the smoothing kernel or morphological kernel size) were chosen based on the analysis of failure cases in the development set and remain fixed for all scans, simplifying the usage.

# Results

We evaluated the performance of Robust Skull Strip V2 against the original CT_BET (V1) on a large and diverse collection of head CT scans. The test dataset consisted of 5,015 non-contrast head CT scans drawn from the MISTIE III clinical trial archive, which encompasses 26 different hospital sites and a variety of scanner manufacturers/models (19 models in total). This multi-center dataset reflects a wide range of patient anatomies, scan qualities, and clinical conditions, providing a rigorous challenge for skull stripping algorithms. Each scan in the dataset was processed with both the baseline method (CT_BET V1) and the proposed Robust Skull Strip V2 pipeline. The outputs were then assessed for quality using a combination of automatic checks and manual review by expert image analysts. A “failure” was defined as a skull-stripping result that was clearly unusable or required manual correction – for example, if significant non-brain tissue remained in the mask (such as neck or bone) or if part of the brain was missing from the mask.

Failure Rate Reduction: The primary outcome metric was the gross failure rate of the skull stripping. The baseline CT_BET (V1) exhibited failures in a substantial fraction of scans, confirming earlier reports of its limitations. Out of 5,015 scans, V1 produced 268 failures, which corresponds to about 5.34% of the cases. In contrast, Robust Skull Strip V2 had only 13 failures out of 5,015, a rate of 0.26%. This represents an order-of-magnitude reduction in failure frequency. In practical terms, whereas an analyst would expect roughly 1 in 20 CT scans to have a bad brain mask with the old method, the new method brings that down to about 1 in 400 scans. Such a low failure rate approaches the realm of routine clinical acceptability, where manual intervention becomes a rarity.

# Discussion

# Conclusion

# Supplemental

#References
